{"is_source_file": true, "format": "JavaScript", "description": "This file defines a 'StorageService' class providing in-memory or file-based CRUD operations for collections such as products, users, orders, and carts in an e-commerce backend.", "external_files": ["fs", "path"], "external_methods": ["fs.promises.mkdir", "fs.promises.readFile", "fs.promises.writeFile"], "published": ["StorageService"], "classes": [{"name": "StorageService", "description": "A class offering storage management with support for in-memory and file-based persistence, including CRUD operations and collection management for an e-commerce platform."}], "methods": [{"name": "init()", "description": "Initializes the storage, loading snapshots if in file mode and seeding default data when collections are empty.", "scope": "StorageService", "scopeKind": "class"}, {"name": "getMode()", "description": "Returns the current persistence mode ('memory' or 'file').", "scope": "StorageService", "scopeKind": "class"}, {"name": "getDataDir()", "description": "Returns the directory used for storing JSON snapshots when in file mode.", "scope": "StorageService", "scopeKind": "class"}, {"name": "shutdown()", "description": "Triggers saving snapshots to disk if in file mode.", "scope": "StorageService", "scopeKind": "class"}, {"name": "products()", "description": "Provides collection helpers for products.", "scope": "StorageService", "scopeKind": "class"}, {"name": "users()", "description": "Provides collection helpers for users.", "scope": "StorageService", "scopeKind": "class"}, {"name": "orders()", "description": "Provides collection helpers for orders.", "scope": "StorageService", "scopeKind": "class"}, {"name": "carts()", "description": "Provides collection helpers for carts.", "scope": "StorageService", "scopeKind": "class"}, {"name": "_autoSave()", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "_collection(name, prefix)", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "_ensureDir(dir)", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "_id(prefix = 'id')", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "_loadSnapshots()", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "_seed()", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}, {"name": "constructor()", "scope": "StorageService", "scopeKind": "class", "description": "unavailable"}], "calls": ["fs.promises.mkdir", "fs.promises.readFile", "fs.promises.writeFile", "this._autoSave()", "this._loadSnapshots()", "this._seed()"], "search-terms": ["StorageService", "file persistence", "CRUD helpers", "e-commerce collections", "snapshot loading"], "state": 2, "file_id": 13, "knowledge_revision": 28, "git_revision": "", "ctags": [{"_type": "tag", "name": "StorageService", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^class StorageService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "_autoSave", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async _autoSave() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "_collection", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  _collection(name, prefix) {$/", "language": "JavaScript", "kind": "method", "signature": "(name, prefix)", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "_ensureDir", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async _ensureDir(dir) {$/", "language": "JavaScript", "kind": "method", "signature": "(dir)", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "_id", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  _id(prefix = 'id') {$/", "language": "JavaScript", "kind": "method", "signature": "(prefix = 'id')", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "_loadSnapshots", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async _loadSnapshots() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "_seed", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async _seed() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "carts", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^      carts: []$/", "language": "JavaScript", "kind": "property", "scope": "StorageService.constructor.state", "scopeKind": "class"}, {"_type": "tag", "name": "carts", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  carts() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  constructor() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^          createdAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "StorageService._collection.item", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^module.exports = new StorageService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^const fs = require('fs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getDataDir", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  getDataDir() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "getMode", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  getMode() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^          id: ref._id(prefix),$/", "language": "JavaScript", "kind": "property", "scope": "StorageService._collection.item", "scopeKind": "class"}, {"_type": "tag", "name": "init", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async init() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "item", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^        const item = {$/", "language": "JavaScript", "kind": "class", "scope": "StorageService._collection", "scopeKind": "class"}, {"_type": "tag", "name": "orders", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^      orders: [],$/", "language": "JavaScript", "kind": "property", "scope": "StorageService.constructor.state", "scopeKind": "class"}, {"_type": "tag", "name": "orders", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  orders() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "products", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^      products: [],$/", "language": "JavaScript", "kind": "property", "scope": "StorageService.constructor.state", "scopeKind": "class"}, {"_type": "tag", "name": "products", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  products() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "shutdown", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  async shutdown() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^    this.state = {$/", "language": "JavaScript", "kind": "class", "scope": "StorageService.constructor", "scopeKind": "class"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^          updatedAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "StorageService._collection.item", "scopeKind": "class"}, {"_type": "tag", "name": "users", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^      users: [],$/", "language": "JavaScript", "kind": "property", "scope": "StorageService.constructor.state", "scopeKind": "class"}, {"_type": "tag", "name": "users", "path": "/home/kavia/workspace/code-generation/unified-e-commerce-platform-186146-186156/backend/src/services/storage.js", "pattern": "/^  users() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "StorageService", "scopeKind": "class"}], "hash": "669194329fb50fb298370d10a19c49f8", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/services/storage.js", "fields": [{"name": "carts: []", "scope": "StorageService.constructor.state", "scopeKind": "class", "description": "unavailable"}, {"name": "createdAt: new Date().toISOString(),", "scope": "StorageService._collection.item", "scopeKind": "class", "description": "unavailable"}, {"name": "module.exports = new StorageService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}, {"name": "id: ref._id(prefix),", "scope": "StorageService._collection.item", "scopeKind": "class", "description": "unavailable"}, {"name": "orders: [],", "scope": "StorageService.constructor.state", "scopeKind": "class", "description": "unavailable"}, {"name": "products: [],", "scope": "StorageService.constructor.state", "scopeKind": "class", "description": "unavailable"}, {"name": "updatedAt: new Date().toISOString(),", "scope": "StorageService._collection.item", "scopeKind": "class", "description": "unavailable"}, {"name": "users: [],", "scope": "StorageService.constructor.state", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"28": ""}]}